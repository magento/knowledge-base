---
title: Security updates available for Adobe Commerce APSB22-12
labels: Adobe Commerce,Magento Open Source,security,patch
promoted: True
---

>![info]
>
>UPDATE: We have discovered additional security protections necessary for CVE-2022-24086 and have released an update to address them (CVE-2022-24087). The security update for customers is available [here](https://helpx.adobe.com/security/products/magento/apsb22-12.html).


Adobe has released security updates for Adobe Commerce and Magento Open Source. These updates resolve a vulnerability rated [critical](https://helpx.adobe.com/security/severity-ratings.html). Successful exploitation could lead to arbitrary code execution.

Adobe is aware that CVE-2022-24086 has been used in very limited attacks targeting Adobe Commerce merchants.
Adobe is not aware of any exploits in the wild for the issue addressed in this update (CVE-2022-24087).

This article provides additional solution details for remediating the issue.

## Affected products and versions

* Adobe Commerce and Magento Open Source 2.3.3-p1 - 2.3.7-p2 and 2.4.0 - 2.4.3-p1

## Solution for Adobe Commerce on cloud infrastructure

The issue was resolved in [Cloud Patches package v1.0.16](https://devdocs.magento.com/cloud/release-notes/mcp-release-notes.html?itm_source=devdocs&itm_medium=search_page&itm_campaign=federated_search&itm_term=v1.0.16#v1016). We recommend upgrading to the [latest Cloud Patches package](https://devdocs.magento.com/cloud/release-notes/mcp-release-notes.html?itm_source=devdocs&itm_medium=search_page&itm_campaign=federated_search&itm_term=v1.0.16#latest) to fix this issue. The latest Cloud Patches package will include all upgrades from earlier packages.

Before upgrading to the latest Cloud Patches package, you need uninstall the custom patches related to APSB22-12. Specifically, the MDVA-43395 and MDVA-43443 patches. Following are the detailed steps.

1. Check whether the patches MDVA-43395 and MDVA-43443 are installed. Follow these [steps](#how-to-tell-whether-the-patches-have-been-applied) to know if the patches are applied.
1. If the patches are installed, [uninstall them](https://devdocs.magento.com/cloud/project/project-patch.html?itm_source=devdocs&itm_medium=search_page&itm_campaign=federated_search&itm_term=uninstall%20patch#revert-a-custom-patch).
1. To upgrade to the latest Cloud Patches package, run the `composer update magento/magento-cloud-patches` command .
1. Commit and push `composer.lock` and `composer.json` files.
1. Redeploy.

## Solution for Magento Open Source

To resolve the vulnerability if you are on Magento Open Source, you must apply two patches: MDVA-43395 patch first, and then MDVA-43443 on top of it.

Use the following attached patches, depending on your Magento Open Source version:

<ins>Magento Open Source 2.4.3 - 2.4.3-p1:</ins>

* [MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip) and [MDVA-43443_EE_2.4.3-p1_COMPOSER_v1.patch.zip](assets/MDVA-43443_EE_2.4.3-p1_COMPOSER_v1.patch.zip)
* [MDVA-43395_EE_2.4.3-p1_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_v1.patch.zip) and [MDVA-43443_EE_2.4.3-p1_v1.patch.zip](assets/MDVA-43443_EE_2.4.3-p1_v1.patch.zip)

<ins>Magento Open Source 2.3.4-p2 - 2.4.2-p2:</ins>

* [MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip) and [MDVA-43443_EE_2.4.2-p2_COMPOSER_v1.patch.zip](assets/MDVA-43443_EE_2.4.2-p2_COMPOSER_v1.patch.zip)
* [MDVA-43395_EE_2.4.3-p1_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_v1.patch.zip) and [MDVA-43443_EE_2.4.2-p2_v1.patch.zip](assets/MDVA-43443_EE_2.4.2-p2_v1.patch.zip)

<ins>Magento Open Source 2.3.3-p1 - 2.3.4:</ins>

* [MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch.zip) and [MDVA-43443_EE_2.3.4_COMPOSER_v1.patch.zip](assets/MDVA-43443_EE_2.3.4_COMPOSER_v1.patch.zip)
* [MDVA-43395_EE_2.4.3-p1_v1.patch.zip](assets/MDVA-43395_EE_2.4.3-p1_v1.patch.zip) and [MDVA-43443_EE_2.3.4_v1.patch.zip](assets/MDVA-43443_EE_2.3.4_v1.patch.zip)

### How to apply a composer patch

Unzip the file and follow instructions in [How to apply a composer patch provided by Adobe](https://support.magento.com/hc/en-us/articles/360028367731).


## How to tell whether the patches have been applied

Considering that it is not possible to easily check if the issue was patched, you might want to check whether the MDVA-43395 and MDVA-43443 patches have been successfully applied.

You can do this by taking the following steps:

1. [Install the Quality Patches Tool](https://devdocs.magento.com/quality-patches/usage.html).
1. Run the following command: `vendor/bin/magento-patches -n status |grep "43395|43443|Status"`
1. You should see this output - MDVA-43395 returns the *N/A* status and MDVA-43443 returns the *Applied* status:

```bash
║ Id            │ Title                                                        │ Category        │ Origin                 │ Status      │ Details                                          ║
║ N/A           │ ../m2-hotfixes/MDVA-43443_EE_2.4.3-p1_COMPOSER_v1.patch      │ Other           │ Local                  │ Applied     │ Patch type: Custom                               ║
║ MDVA-43395    │ Parser token fix                                             │ Other           │ Adobe Commerce Support │ N/A         │ Patch type: Required                             ║
║ N/A           │ ../m2-hotfixes/MDVA-43395_EE_2.4.3-p1_COMPOSER_v1.patch      │ Other           │ Local                  │ N/A         │ Patch type: Custom                               ║
```

## Security updates

Security updates available for Adobe Commerce:

* [Adobe Security Bulletin (APSB22-12)](https://helpx.adobe.com/security/products/magento/apsb22-12.html)
